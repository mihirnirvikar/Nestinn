<%- layout('layouts/boilerplate'); %>

    <% if(success && success.length) { %>
        <div class="alert alert-success alert-dismissible fade show col-6 offset-3 mt-3" role="alert">
            <%= success %>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <% } %>

            <body>
                <div class="showContainer">
                    <h3 class="showHeading">
                        <%= listing.title %>
                    </h3>
                    <img class="showImage" src="<%= listing.image %>" alt="Listing Image">
                    <div class="showDetail">

                        <span class="showDescription">
                            <%= listing.description %>
                        </span>
                        <br>
                        <span class="showPrice">
                            &#x20B9 <%= listing.price.toLocaleString('en-IN') %>
                                for 2 nights
                        </span>
                        <br>
                        <span class="showLocation">
                            <%= listing.location %>
                        </span>
                        <br>
                        <span class="showCountry">
                            <%= listing.country %>
                        </span>
                    </div>
                    <br>
                    <br>

                    <div class="showEditDeleteBtn">
                        <a class="editBtn" href="http://localhost:8080/listings/<%= listing._id %>/edit">Edit this
                            Listing</a>
                        <br><br>
                        <form method="POST" action="http://localhost:8080/listings/<%= listing._id %>?_method=DELETE">
                            <button class="deleteBtn" type="submit">Delete this Listing</button>
                        </form>
                    </div>

                    <hr>

                    <div class="showReviews mt-3 ms-3">
                        <p class="h4 fw-light"><b>Share Your Experience</b></p>

                        <form action="/listings/<%= listing._id %>/reviews" method="POST" class="needs-validation"
                            novalidate>
                            <div class="mt-4 mb-3">
                                <label for="customRange2" class="form-label">Rating</label>
                                <input type="range" class="form-range" min="1" max="5" id="customRange2" name="rating">
                            </div>

                            <div class="mb-4">
                                <label for="validationCustom02" class="form-label">Comments</label>
                                <textarea type="text" class="form-control" id="validationCustom02" name="comment"
                                    placeholder="Enter your Comments" required></textarea>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please provide a valid description.
                                </div>
                            </div>

                            <button class=" btn btn-dark px-4 py-1 mt-3 mb-3" type="submit">Submit</button>
                        </form>
                    </div>
                    <hr>

                    <div class="ms-3">
                        <p class="h4 fw-light"><b>Reviews</b></p>

                        <div class="d-flex flex-wrap ">
                            <% for(let review of listing.reviews) { %>
                                <div class="card m-3" style="width: 20rem;">
                                    <div class="card-body ">
                                        <div class="d-flex justify-content-between">
                                            <h5 class="card-User">John Doe</h5>
                                            <form class="" method="POST"
                                                action="/listings/<%= listing._id%>/reviews/<%=review._id%>?_method=DELETE">
                                                <button type="submit" class="btn btn-dark btn-sm">Delete</button>
                                            </form>

                                        </div>

                                        <p class="card-rating">
                                            <%= review.rating %> starts
                                        </p>
                                        <p class="card-comment">
                                            <%= review.comment %>
                                        </p>
                                    </div>
                                </div>
                                <% } %>
                        </div>




                    </div>


                </div>

            </body>